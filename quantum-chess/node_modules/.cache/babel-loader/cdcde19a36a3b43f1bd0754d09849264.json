{"ast":null,"code":"var _jsxFileName = \"/home/jaybird/Coding Projects/Chess4/chess/src/components/chessboard/chessboard.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useRef, useState } from 'react';\nimport Tile from '../Tile/Tile';\nimport './chessboard.css';\nimport Referee from '../../referee/Referee';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst horizontalAxis = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h'];\nconst verticalAxis = [1, 2, 3, 4, 5, 6, 7, 8];\nexport let TeamType;\n\n(function (TeamType) {\n  TeamType[TeamType[\"WHITE\"] = 0] = \"WHITE\";\n  TeamType[TeamType[\"BLACK\"] = 1] = \"BLACK\";\n})(TeamType || (TeamType = {}));\n\nexport let PieceType; // Setting Up board starting position\n\n(function (PieceType) {\n  PieceType[PieceType[\"PAWN\"] = 0] = \"PAWN\";\n  PieceType[PieceType[\"BISHOP\"] = 1] = \"BISHOP\";\n  PieceType[PieceType[\"NIGHT\"] = 2] = \"NIGHT\";\n  PieceType[PieceType[\"ROOK\"] = 3] = \"ROOK\";\n  PieceType[PieceType[\"QUEEN\"] = 4] = \"QUEEN\";\n  PieceType[PieceType[\"KING\"] = 5] = \"KING\";\n})(PieceType || (PieceType = {}));\n\nconst BoardState = [];\n\nfor (let p = 0; p < 2; p++) {\n  const type = p === 0 ? 'b' : 'w';\n  const team = p === 0 ? TeamType.BLACK : TeamType.WHITE;\n  const y = p === 0 ? 7 : 0; // Rooks\n\n  BoardState.push({\n    image: `assets/images/rook_${type}.png`,\n    x: 0,\n    y,\n    team,\n    type: PieceType.ROOK\n  });\n  BoardState.push({\n    image: `assets/images/rook_${type}.png`,\n    x: 7,\n    y,\n    team,\n    type: PieceType.ROOK\n  }); // Nights\n\n  BoardState.push({\n    image: `assets/images/night_${type}.png`,\n    x: 1,\n    y,\n    team,\n    type: PieceType.NIGHT\n  });\n  BoardState.push({\n    image: `assets/images/night_${type}.png`,\n    x: 6,\n    y,\n    team,\n    type: PieceType.NIGHT\n  }); // Bishops\n\n  BoardState.push({\n    image: `assets/images/bishop_${type}.png`,\n    x: 2,\n    y,\n    team,\n    type: PieceType.BISHOP\n  });\n  BoardState.push({\n    image: `assets/images/bishop_${type}.png`,\n    x: 5,\n    y,\n    team,\n    type: PieceType.BISHOP\n  }); // Queens\n\n  BoardState.push({\n    image: `assets/images/queen_${type}.png`,\n    x: 3,\n    y,\n    team,\n    type: PieceType.QUEEN\n  }); // Kings\n\n  BoardState.push({\n    image: `assets/images/king_${type}.png`,\n    x: 4,\n    y,\n    team,\n    type: PieceType.KING\n  });\n} // Pawns\n\n\nfor (let i = 0; i < horizontalAxis.length; i++) {\n  BoardState.push({\n    image: 'assets/images/pawn_b.png',\n    x: i,\n    y: 6,\n    team: TeamType.BLACK,\n    type: PieceType.PAWN\n  });\n}\n\nfor (let i = 0; i < horizontalAxis.length; i++) {\n  BoardState.push({\n    image: 'assets/images/pawn_w.png',\n    x: i,\n    y: 1,\n    team: TeamType.WHITE,\n    type: PieceType.PAWN\n  });\n}\n\nexport default function Chessboard() {\n  _s();\n\n  const [activePiece, setActivePiece] = useState(null);\n  const [gridX, setGridX] = useState(0);\n  const [gridY, setGridY] = useState(0);\n  const [pieces, setPieces] = useState(BoardState);\n  const chessboardRef = useRef(null);\n  const referee = new Referee();\n\n  function grabPiece(e) {\n    const chessboard = chessboardRef.current;\n    const element = e.target;\n\n    if (element.classList.contains('chess-piece') && chessboard) {\n      setGridX(Math.floor((e.clientX - chessboard.offsetLeft) / 100));\n      setGridY(Math.abs(Math.ceil((e.clientY - chessboard.offsetTop - 800) / 100)));\n      const x = e.clientX - 50;\n      const y = e.clientY - 50;\n      element.style.position = 'absolute';\n      element.style.left = `${x}px`;\n      element.style.top = `${y}px`;\n      setActivePiece(element);\n    }\n  }\n\n  function movePiece(e) {\n    const chessboard = chessboardRef.current;\n\n    if (activePiece && chessboard) {\n      const minX = chessboard.offsetLeft - 25;\n      const minY = chessboard.offsetTop - 25;\n      const maxX = chessboard.offsetLeft + chessboard.clientWidth - 75;\n      const maxY = chessboard.offsetTop + chessboard.clientHeight - 75;\n      const x = e.clientX - 50;\n      const y = e.clientY - 50;\n      activePiece.style.position = 'absolute';\n\n      if (x < minX) {\n        activePiece.style.left = `${minX}px`;\n      } else if (x > maxX) {\n        activePiece.style.left = `${maxX}px`;\n      } else {\n        activePiece.style.left = `${x}px`;\n      }\n\n      if (y < minY) {\n        activePiece.style.top = `${minY}px`;\n      } else if (y > maxY) {\n        activePiece.style.top = `${maxY}px`;\n      } else {\n        activePiece.style.top = `${y}px`;\n      }\n    }\n  }\n\n  function dropPiece(e) {\n    const chessboard = chessboardRef.current;\n\n    if (activePiece && chessboard) {\n      const x = Math.floor((e.clientX - chessboard.offsetLeft) / 100);\n      const y = Math.abs(Math.ceil((e.clientY - chessboard.offsetTop - 800) / 100));\n      const attackedPiece = pieces.find(p => p.x === x && p.y === y);\n      const currentPiece = pieces.find(p => p.x === gridX && p.y === gridY);\n\n      if (currentPiece) {\n        const validMove = referee.isValidMove(gridX, gridY, x, y, currentPiece.type, currentPiece.team, pieces);\n\n        if (validMove) {\n          const id1 = pieces.indexOf(currentPiece);\n          currentPiece.x = x;\n          currentPiece.y = y;\n          pieces[id1] = currentPiece;\n          setPieces(pieces);\n\n          if (attackedPiece) {\n            const id2 = pieces.indexOf(attackedPiece);\n            pieces.splice(id2, 1);\n          }\n        } else {\n          activePiece.style.position = 'relative';\n          activePiece.style.removeProperty('left');\n          activePiece.style.removeProperty('top');\n        }\n      }\n    }\n\n    setActivePiece(null);\n  }\n\n  let board = [];\n\n  for (let j = verticalAxis.length - 1; j >= 0; j--) {\n    for (let i = 0; i < horizontalAxis.length; i++) {\n      const number = i + j;\n      let image = undefined;\n      pieces.forEach(p => {\n        if (p.x === i && p.y === j) {\n          image = p.image;\n        }\n      });\n      board.push( /*#__PURE__*/_jsxDEV(Tile, {\n        image: image,\n        number: number\n      }, `${i}, ${j}`, false, {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 24\n      }, this));\n    }\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: chessboardRef,\n    onMouseUp: e => dropPiece(e),\n    onMouseMove: e => movePiece(e),\n    onMouseDown: e => grabPiece(e),\n    id: \"chessboard\",\n    children: board\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 167,\n    columnNumber: 12\n  }, this);\n}\n\n_s(Chessboard, \"KqvFF3YTGOvBIZvXCjHcbpoEeCY=\");\n\n_c = Chessboard;\n\nvar _c;\n\n$RefreshReg$(_c, \"Chessboard\");","map":{"version":3,"sources":["/home/jaybird/Coding Projects/Chess4/chess/src/components/chessboard/chessboard.tsx"],"names":["React","useRef","useState","Tile","Referee","horizontalAxis","verticalAxis","TeamType","PieceType","BoardState","p","type","team","BLACK","WHITE","y","push","image","x","ROOK","NIGHT","BISHOP","QUEEN","KING","i","length","PAWN","Chessboard","activePiece","setActivePiece","gridX","setGridX","gridY","setGridY","pieces","setPieces","chessboardRef","referee","grabPiece","e","chessboard","current","element","target","classList","contains","Math","floor","clientX","offsetLeft","abs","ceil","clientY","offsetTop","style","position","left","top","movePiece","minX","minY","maxX","clientWidth","maxY","clientHeight","dropPiece","attackedPiece","find","currentPiece","validMove","isValidMove","id1","indexOf","id2","splice","removeProperty","board","j","number","undefined","forEach"],"mappings":"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","sourcesContent":["import React, {useRef, useState } from 'react';\nimport Tile from '../Tile/Tile';\nimport './chessboard.css';\nimport Referee from '../../referee/Referee'\nimport { relative } from 'path';\n\n\nconst horizontalAxis = ['a', 'b', 'c', 'd', 'e', 'f',   'g', 'h'];\nconst verticalAxis = [1,2,3,4,5,6,7,8];\n\nexport interface Piece {\n    image: string;\n    x : number; \n    y : number; \n    type : PieceType;\n    team : TeamType;\n}\n\nexport enum TeamType{\n    WHITE,\n    BLACK\n}\n\nexport enum PieceType {\n    PAWN,\n    BISHOP, \n    NIGHT, \n    ROOK,\n    QUEEN,\n    KING,\n}\n\n// Setting Up board starting position\nconst BoardState : Piece[] = [];\n\nfor (let p = 0; p < 2; p ++){\n    const type = p === 0 ? 'b': 'w';\n    const team = p === 0 ? TeamType.BLACK : TeamType.WHITE;\n    const y = p === 0 ?  7 : 0;\n    // Rooks\n    BoardState.push({image : `assets/images/rook_${type}.png`, x : 0,  y, team, type : PieceType.ROOK})\n    BoardState.push({image : `assets/images/rook_${type}.png`, x : 7,  y, team, type : PieceType.ROOK})\n\n    // Nights\n    BoardState.push({image : `assets/images/night_${type}.png`, x : 1,  y, team, type : PieceType.NIGHT})\n    BoardState.push({image : `assets/images/night_${type}.png`, x : 6,  y, team, type : PieceType.NIGHT})\n\n    // Bishops\n    BoardState.push({image : `assets/images/bishop_${type}.png`, x : 2,  y, team, type : PieceType.BISHOP})\n    BoardState.push({image : `assets/images/bishop_${type}.png`, x : 5,  y, team, type : PieceType.BISHOP})\n\n    // Queens\n    BoardState.push({image : `assets/images/queen_${type}.png`, x : 3,  y, team, type : PieceType.QUEEN})\n    // Kings\n    BoardState.push({image : `assets/images/king_${type}.png`, x : 4,  y, team, type : PieceType.KING})\n\n}\n\n// Pawns\nfor (let i = 0; i < horizontalAxis.length; i++){\n    BoardState.push({image : 'assets/images/pawn_b.png', x : i, y : 6, team : TeamType.BLACK, type : PieceType.PAWN})\n}\nfor (let i = 0; i < horizontalAxis.length; i++){\n    BoardState.push({image : 'assets/images/pawn_w.png', x : i, y : 1, team : TeamType.WHITE, type : PieceType.PAWN})\n}\n\n\n\nexport default function Chessboard(){\n    const [activePiece, setActivePiece] = useState<HTMLElement | null>(null) \n    const [gridX, setGridX] = useState(0);\n    const [gridY, setGridY] = useState(0);\n    const [pieces, setPieces]  = useState<Piece[]>(BoardState);\n    const chessboardRef = useRef<HTMLDivElement>(null);\n    const referee = new Referee();\n\n    function grabPiece(e: React.MouseEvent){\n        const chessboard = chessboardRef.current\n        const element = e.target as HTMLElement\n        if (element.classList.contains('chess-piece') && chessboard){\n            setGridX(Math.floor((e.clientX - chessboard.offsetLeft)/100));\n            setGridY(Math.abs(Math.ceil((e.clientY - chessboard.offsetTop - 800)/100)));\n            const x = e.clientX - 50;\n            const y = e.clientY - 50;\n            element.style.position = 'absolute'; \n            element.style.left = `${x}px`;\n            element.style.top = `${y}px`;\n            setActivePiece(element)    \n        }\n    \n    }\n    \n    function movePiece(e: React.MouseEvent){\n        const chessboard = chessboardRef.current\n        if (activePiece && chessboard){\n            const minX = chessboard.offsetLeft - 25;\n            const minY = chessboard.offsetTop - 25;\n            const maxX = chessboard.offsetLeft + chessboard.clientWidth -75;\n            const maxY = chessboard.offsetTop + chessboard.clientHeight -75;\n            const x = e.clientX -50;\n            const y = e.clientY -50;\n            activePiece.style.position = 'absolute'; \n            if (x < minX) {\n                activePiece.style.left = `${minX}px` ;\n            } else if (x > maxX) {\n                activePiece.style.left = `${maxX}px`;\n            } else {\n                activePiece.style.left = `${x}px`;\n            }\n            if (y < minY) {\n                activePiece.style.top = `${minY}px`;\n            } else if (y > maxY) {\n                activePiece.style.top = `${maxY}px`;\n            } else {\n                activePiece.style.top = `${y}px`;\n            }\n        }\n    }\n    \n    function dropPiece(e: React.MouseEvent){\n        const chessboard = chessboardRef.current;\n        if (activePiece && chessboard){\n            const x = Math.floor((e.clientX - chessboard.offsetLeft)/100);\n            const y = Math.abs(Math.ceil((e.clientY - chessboard.offsetTop - 800)/100))\n            const attackedPiece = pieces.find(p => p.x === x && p.y ===y)\n            const currentPiece = pieces.find(p => p.x === gridX && p.y ===gridY)\n            if (currentPiece){\n                const validMove = referee.isValidMove(gridX, gridY, x, y, currentPiece.type, currentPiece.team, pieces);\n                if (validMove){\n                    const id1 = pieces.indexOf(currentPiece)\n                    currentPiece.x = x\n                    currentPiece.y = y\n                    pieces[id1] = currentPiece\n                    setPieces(pieces)\n                    if (attackedPiece){\n                        const id2 = pieces.indexOf(attackedPiece)\n                        pieces.splice(id2, 1)\n                    }\n                } else {\n                    activePiece.style.position = 'relative';\n                    activePiece.style.removeProperty('left');\n                    activePiece.style.removeProperty('top');\n                }\n            }\n        }\n        setActivePiece(null);\n    }\n\n\n\n\n\n    let board = [];\n    for (let j = verticalAxis.length - 1; j >= 0; j-- ){\n        for (let i = 0; i < horizontalAxis.length; i++ ) {\n            const number = i + j;\n            let image = undefined;\n            pieces.forEach(p => {\n                if (p.x === i && p.y === j){\n                    image = p.image;\n                }\n                \n            }); \n            board.push(<Tile key = {`${i}, ${j}`} image = {image} number = {number}/>);\n        }\n    }\n    return <div \n    ref = {chessboardRef} \n    onMouseUp = {e => dropPiece(e)} \n    onMouseMove = {e => movePiece(e)} \n    onMouseDown = {e => grabPiece(e)} \n    id = 'chessboard'>{board}</div>;\n}"]},"metadata":{},"sourceType":"module"}