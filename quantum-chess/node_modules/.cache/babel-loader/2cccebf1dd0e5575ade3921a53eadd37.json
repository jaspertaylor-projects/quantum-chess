{"ast":null,"code":"/*\nThis function updates the Piece [] so that the piece moves to its new location. It\nalso handles the case where a piece is taken and when a ROOK is teleported via \nthe castling move.\n*/\nimport { PieceType, TeamType } from '../constants';\nimport SuperPiece from '../superPiece';\nexport let TAKEN_PIECE = null;\nexport function setTAKEN(piece) {\n  TAKEN_PIECE = piece;\n}\nexport function executeMove(px, py, x, y, possiblePieces, activePlayer, boardState) {\n  const takenPiece = boardState.find(p => p.x === x && p.y === y && p.SuperPiece.team !== activePlayer);\n  promote(activePlayer, boardState);\n\n  if (takenPiece) {\n    TAKEN_PIECE = takenPiece;\n    takePiece(takenPiece, boardState);\n  } else {\n    TAKEN_PIECE = null;\n  }\n\n  const currentPiece = boardState.find(p => p.x === px && p.y === py);\n\n  if (currentPiece) {\n    const id = boardState.indexOf(currentPiece);\n    boardState[id] = {\n      SuperPiece: new SuperPiece(possiblePieces, activePlayer),\n      x,\n      y\n    };\n  }\n}\nexport function fakeMove(px, py, x, y, possiblePieces, activePlayer, boardState) {\n  const takenPiece = boardState.find(p => p.x === x && p.y === y && p.SuperPiece.team !== activePlayer);\n\n  if (takenPiece) {\n    takePiece(takenPiece, boardState);\n  }\n\n  const currentPiece = boardState.find(p => p.x === px && p.y === py);\n\n  if (currentPiece) {\n    const id = boardState.indexOf(currentPiece);\n    boardState[id] = {\n      SuperPiece: new SuperPiece(possiblePieces, activePlayer),\n      x,\n      y\n    };\n  }\n}\n\nfunction promote(activePlayer, boardState) {\n  let promoted = undefined;\n\n  if (activePlayer = TeamType.WHITE) {\n    promoted = boardState.find(p => p.SuperPiece.subPieces === [PieceType.PAWN] && p.SuperPiece.team === activePlayer && p.y === 7);\n\n    if (promoted) {\n      promoted.promoted = true;\n    }\n  }\n\n  if (activePlayer = TeamType.WHITE) {\n    promoted = boardState.find(p => p.SuperPiece.subPieces === [PieceType.PAWN] && p.SuperPiece.team === activePlayer && p.y === 0);\n\n    if (promoted) {\n      promoted.promoted = true;\n    }\n  }\n}\n\nfunction takePiece(p, boardState) {\n  const id = boardState.indexOf(p);\n  boardState.splice(id, 1);\n}","map":{"version":3,"sources":["/home/jaybird/Coding Projects/QuantumChess/quantum-chess/src/Referee/executeMove.ts"],"names":["PieceType","TeamType","SuperPiece","TAKEN_PIECE","setTAKEN","piece","executeMove","px","py","x","y","possiblePieces","activePlayer","boardState","takenPiece","find","p","team","promote","takePiece","currentPiece","id","indexOf","fakeMove","promoted","undefined","WHITE","subPieces","PAWN","splice"],"mappings":"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","sourcesContent":["/*\nThis function updates the Piece [] so that the piece moves to its new location. It\nalso handles the case where a piece is taken and when a ROOK is teleported via \nthe castling move.\n*/\n\n\n\nimport { PROMOTED_PIECE } from '../components/Promotion/promotion'\nimport { Piece, PieceType, TeamType } from '../constants'\nimport SuperPiece from '../superPiece'\n\nexport let TAKEN_PIECE : Piece | null = null\n\n\n\n\n\n\n\nexport function setTAKEN(piece : Piece | null){\n    TAKEN_PIECE = piece\n}\n\nexport function executeMove (px : number, py : number, x : number, y: number,\n                            possiblePieces : PieceType [], activePlayer : TeamType, boardState : Piece []) {\n    const takenPiece = boardState.find(p => p.x === x && p.y === y && p.SuperPiece.team !== activePlayer)\n    promote(activePlayer, boardState)\n    if (takenPiece){\n        TAKEN_PIECE = takenPiece\n        takePiece(takenPiece, boardState)\n    } else {\n        TAKEN_PIECE = null\n    }\n    const currentPiece = boardState.find(p => p.x === px && p.y === py) \n    if (currentPiece){\n        const id = boardState.indexOf(currentPiece)\n        boardState[id] = {SuperPiece : new SuperPiece(possiblePieces, activePlayer), x, y}    \n    }\n}\n\nexport function fakeMove (px : number, py : number, x : number, y: number,\n    possiblePieces : PieceType [], activePlayer : TeamType, boardState : Piece []) {\n    const takenPiece = boardState.find(p => p.x === x && p.y === y && p.SuperPiece.team !== activePlayer)\n    if (takenPiece){\n    takePiece(takenPiece, boardState)\n    } \n    const currentPiece = boardState.find(p => p.x === px && p.y === py) \n    if (currentPiece){\n        const id = boardState.indexOf(currentPiece)\n        boardState[id] = {SuperPiece : new SuperPiece(possiblePieces, activePlayer), x, y}    \n    }\n}\n\n\n\nfunction promote(activePlayer : TeamType, boardState : Piece []){\n    let promoted : Piece | undefined = undefined\n    if (activePlayer = TeamType.WHITE){\n        promoted = boardState.find(p => p.SuperPiece.subPieces === [PieceType.PAWN] \n                                    && p.SuperPiece.team === activePlayer && p.y === 7)\n        if(promoted){\n            promoted.promoted = true\n        }\n    }\n    if (activePlayer = TeamType.WHITE){\n        promoted = boardState.find(p => p.SuperPiece.subPieces === [PieceType.PAWN] \n                                    && p.SuperPiece.team === activePlayer && p.y === 0)\n        if(promoted){\n            promoted.promoted = true\n        }\n    }\n}\n\nfunction takePiece(p : Piece, boardState : Piece []){\n    const id = boardState.indexOf(p)\n    boardState.splice(id, 1)\n}\n"]},"metadata":{},"sourceType":"module"}