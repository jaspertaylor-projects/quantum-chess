{"ast":null,"code":"import { TAKEN_PIECES_BLACK, TAKEN_PIECES_WHITE } from \"../components/TakePiece/TakePiece\";\nimport { PieceType, TeamType } from \"../constants\";\nconst all_pieces = [PieceType.KING, PieceType.QUEEN, PieceType.ROOK, PieceType.BISHOP, PieceType.NIGHT, PieceType.PAWN];\nlet whiteNumPiece = [1, 1, 2, 2, 2, 8];\nlet blackNumPiece = [1, 1, 2, 2, 2, 8];\nlet count = 0;\n\nfunction collapsed(piece, boardState, team) {\n  let ids = [];\n\n  for (let i = 0; i < boardState.length; i++) {\n    if (boardState[i].SuperPiece.equals([...piece]) && boardState[i].SuperPiece.team === team) {\n      ids.push(i);\n    }\n  }\n\n  return ids;\n}\n\nfunction remove(piece, boardState, team, level) {\n  for (let p = 0; p < piece.length; p++) for (let i = 0; i < boardState.length; i++) {\n    if (boardState[i].SuperPiece.subPieces.length > level && boardState[i].SuperPiece.subPieces.includes(piece[p]) && boardState[i].SuperPiece.team === team) {\n      const id = boardState[i].SuperPiece.subPieces.indexOf(piece[p]);\n      boardState[i].SuperPiece.subPieces.splice(id, 1);\n      count = count + 1;\n    }\n  }\n}\n\nfunction first_level_collapse(boardState, team) {\n  const arr1 = team === TeamType.WHITE ? whiteNumPiece : blackNumPiece;\n  const arr2 = team === TeamType.WHITE ? TAKEN_PIECES_WHITE : TAKEN_PIECES_BLACK;\n\n  for (let i = 0; i < all_pieces.length; i++) {\n    const ids = collapsed([all_pieces[i]], boardState, team, 1);\n\n    if (ids.length + arr2[i] === arr1[i]) {\n      remove([all_pieces[i]], boardState, team, 1);\n    }\n  }\n}\n\nfunction second_level_collapse(boardState, team) {\n  const arr1 = team === TeamType.WHITE ? whiteNumPiece : blackNumPiece;\n  const arr2 = team === TeamType.WHITE ? TAKEN_PIECES_WHITE : TAKEN_PIECES_BLACK;\n\n  for (let i = 0; i < all_pieces.length; i++) {\n    for (let j = i + 1; j < all_pieces.length; j++) {\n      const piece_combo = [all_pieces[i], all_pieces[j]];\n      const ids = collapsed(piece_combo, boardState, team, 2);\n\n      if (ids.length + arr2[i] + arr2[j] === arr1[i] + arr1[j]) {\n        remove(piece_combo, boardState, team, 2);\n      }\n    }\n  }\n}\n\nfunction third_level_collapse(boardState, team) {\n  const arr1 = team === TeamType.WHITE ? whiteNumPiece : blackNumPiece;\n  const arr2 = team === TeamType.WHITE ? TAKEN_PIECES_WHITE : TAKEN_PIECES_BLACK;\n\n  for (let i = 0; i < all_pieces.length; i++) {\n    for (let j = i + 1; j < all_pieces.length; j++) {\n      for (let k = j + 1; k < all_pieces.length; k++) {\n        const piece_combo = [all_pieces[i], all_pieces[j], all_pieces[k]];\n        const ids = collapsed(piece_combo, boardState, team, 3);\n\n        if (ids.length + arr2[i] + arr2[j] + arr2[k] === arr1[i] + arr1[j] + arr1[k]) {\n          remove(piece_combo, boardState, team, 3);\n        }\n      }\n    }\n  }\n}\n\nfunction fourth_level_collapse(boardState, team) {\n  const arr1 = team === TeamType.WHITE ? whiteNumPiece : blackNumPiece;\n  const arr2 = team === TeamType.WHITE ? TAKEN_PIECES_WHITE : TAKEN_PIECES_BLACK;\n\n  for (let i = 0; i < all_pieces.length; i++) {\n    for (let j = i + 1; j < all_pieces.length; j++) {\n      for (let k = j + 1; k < all_pieces.length; k++) {\n        for (let l = k + 1; l < all_pieces.length; l++) {\n          const piece_combo = [all_pieces[i], all_pieces[j], all_pieces[k], all_pieces[l]];\n          const ids = collapsed(piece_combo, boardState, team, 4);\n\n          if (ids.length + arr2[i] + arr2[j] + arr2[k] + arr2[l] === arr1[i] + arr1[j] + arr1[k] + arr1[l]) {\n            remove(piece_combo, boardState, team, 4);\n          }\n        }\n      }\n    }\n  }\n}\n\nfunction fifth_level_collapse(boardState, team) {\n  const arr1 = team === TeamType.WHITE ? whiteNumPiece : blackNumPiece;\n  const arr2 = team === TeamType.WHITE ? TAKEN_PIECES_WHITE : TAKEN_PIECES_BLACK;\n\n  for (let i = 0; i < all_pieces.length; i++) {\n    for (let j = i + 1; j < all_pieces.length; j++) {\n      for (let k = j + 1; k < all_pieces.length; k++) {\n        for (let l = k + 1; l < all_pieces.length; l++) {\n          for (let m = l + 1; l < all_pieces.length; l++) {\n            const piece_combo = [all_pieces[i], all_pieces[j], all_pieces[k], all_pieces[l], all_pieces[m]];\n            const ids = collapsed(piece_combo, boardState, team, 5);\n\n            if (ids.length + arr2[i] + arr2[j] + arr2[k] + arr2[l] + arr2[m] === arr1[i] + arr1[j] + arr1[k] + arr1[l] + arr2[m]) {\n              remove(piece_combo, boardState, team, 5);\n            }\n          }\n        }\n      }\n    }\n  }\n}\n\nexport default function fullReduction(boardState) {\n  let somethingChanged = true;\n\n  while (somethingChanged === true) {\n    first_level_collapse(boardState, TeamType.WHITE);\n    first_level_collapse(boardState, TeamType.BLACK);\n    second_level_collapse(boardState, TeamType.WHITE);\n    second_level_collapse(boardState, TeamType.BLACK);\n    third_level_collapse(boardState, TeamType.WHITE);\n    third_level_collapse(boardState, TeamType.BLACK);\n    fourth_level_collapse(boardState, TeamType.WHITE);\n    fourth_level_collapse(boardState, TeamType.BLACK);\n    fifth_level_collapse(boardState, TeamType.WHITE);\n    fifth_level_collapse(boardState, TeamType.BLACK);\n    somethingChanged = count !== 0;\n    count = 0;\n  }\n}","map":{"version":3,"sources":["/home/jaybird/Coding Projects/QuantumChess/quantum-chess/src/Referee/stateReducer.ts"],"names":["TAKEN_PIECES_BLACK","TAKEN_PIECES_WHITE","PieceType","TeamType","all_pieces","KING","QUEEN","ROOK","BISHOP","NIGHT","PAWN","whiteNumPiece","blackNumPiece","count","collapsed","piece","boardState","team","ids","i","length","SuperPiece","equals","push","remove","level","p","subPieces","includes","id","indexOf","splice","first_level_collapse","arr1","WHITE","arr2","second_level_collapse","j","piece_combo","third_level_collapse","k","fourth_level_collapse","l","fifth_level_collapse","m","fullReduction","somethingChanged","BLACK"],"mappings":"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","sourcesContent":["import { TAKEN_PIECES_BLACK, TAKEN_PIECES_WHITE } from \"../components/TakePiece/TakePiece\";\nimport { Piece, PieceType, TeamType } from \"../constants\";\n\n\nconst all_pieces = [PieceType.KING, PieceType.QUEEN, PieceType.ROOK, PieceType.BISHOP, PieceType.NIGHT, PieceType.PAWN]\n\n\nlet whiteNumPiece : number [] = [1, 1, 2, 2, 2, 8]\nlet blackNumPiece : number [] = [1, 1, 2, 2, 2, 8]\nlet count : number = 0\n\n\n\nfunction collapsed(piece : PieceType [], boardState : Piece [], team : TeamType) : number [] {\n    let ids : number [] = []\n    for(let i = 0; i < boardState.length; i ++){\n        if ( boardState[i].SuperPiece.equals([...piece]) &&\n            boardState[i].SuperPiece.team === team){\n            ids.push(i)\n        }\n    }\n    return ids\n}\n\nfunction remove(piece : PieceType [], boardState : Piece [], team : TeamType, level : number){\n    for (let p = 0; p < piece.length; p++)\n        for(let i = 0; i < boardState.length; i ++){\n            if (boardState[i].SuperPiece.subPieces.length > level && \n                boardState[i].SuperPiece.subPieces.includes(piece[p]) && \n                boardState[i].SuperPiece.team === team){\n                const id = boardState[i].SuperPiece.subPieces.indexOf(piece[p])\n                boardState[i].SuperPiece.subPieces.splice(id, 1)\n                count = count + 1\n            }\n        }\n    }\n\nfunction first_level_collapse(boardState : Piece [], team : TeamType) {\n    const arr1 = team === TeamType.WHITE ? whiteNumPiece : blackNumPiece\n    const arr2 = team === TeamType.WHITE ? TAKEN_PIECES_WHITE : TAKEN_PIECES_BLACK\n    for (let i =  0; i < all_pieces.length; i++){\n        const ids = collapsed([all_pieces[i]], boardState, team, 1)\n        if (ids.length + arr2[i] === arr1[i]){\n            remove([all_pieces[i]], boardState, team, 1)               \n        }\n    }\n}\n\nfunction second_level_collapse(boardState : Piece [], team : TeamType) {\n    const arr1 = team === TeamType.WHITE ? whiteNumPiece : blackNumPiece\n    const arr2 = team === TeamType.WHITE ? TAKEN_PIECES_WHITE : TAKEN_PIECES_BLACK\n    for (let i =  0; i < all_pieces.length; i++){\n        for(let j = i + 1; j < all_pieces.length; j ++){\n            const piece_combo = [all_pieces[i], all_pieces[j]]\n            const ids = collapsed(piece_combo, boardState, team, 2)\n            if (ids.length + arr2[i] + arr2[j] === arr1[i] + arr1[j]){\n                remove(piece_combo, boardState, team, 2)               \n            }\n        }\n    }\n}\n\n\nfunction third_level_collapse(boardState : Piece [], team : TeamType) {\n    const arr1 = team === TeamType.WHITE ? whiteNumPiece : blackNumPiece\n    const arr2 = team === TeamType.WHITE ? TAKEN_PIECES_WHITE : TAKEN_PIECES_BLACK\n    for (let i =  0; i < all_pieces.length; i++){\n        for(let j = i + 1; j < all_pieces.length; j ++){\n            for(let k = j + 1; k < all_pieces.length; k ++){\n                const piece_combo = [all_pieces[i], all_pieces[j], all_pieces[k]]\n                const ids = collapsed(piece_combo, boardState, team, 3)\n                if (ids.length + arr2[i] + arr2[j] + arr2[k] === arr1[i] + arr1[j] + arr1[k]){\n                    remove(piece_combo, boardState, team, 3)               \n                }\n            }\n        }\n    }\n}\n\n\n\n\nfunction fourth_level_collapse(boardState : Piece [], team : TeamType) {\n    const arr1 = team === TeamType.WHITE ? whiteNumPiece : blackNumPiece\n    const arr2 = team === TeamType.WHITE ? TAKEN_PIECES_WHITE : TAKEN_PIECES_BLACK\n    for (let i =  0; i < all_pieces.length; i++){\n        for(let j = i + 1; j < all_pieces.length; j ++){\n            for(let k = j + 1; k < all_pieces.length; k ++){\n                for(let l = k + 1; l < all_pieces.length; l ++){\n                    const piece_combo = [all_pieces[i], all_pieces[j], all_pieces[k], all_pieces[l]]\n                    const ids = collapsed(piece_combo, boardState, team, 4)\n                    if (ids.length + arr2[i] + arr2[j] + arr2[k] + arr2[l] === arr1[i] + arr1[j] + arr1[k] + arr1[l]){\n                        remove(piece_combo, boardState, team, 4)               \n                    }\n                }\n            }\n        }\n    }\n}\n\nfunction fifth_level_collapse(boardState : Piece [], team : TeamType) {\n    const arr1 = team === TeamType.WHITE ? whiteNumPiece : blackNumPiece\n    const arr2 = team === TeamType.WHITE ? TAKEN_PIECES_WHITE : TAKEN_PIECES_BLACK\n    for (let i =  0; i < all_pieces.length; i++){\n        for(let j = i + 1; j < all_pieces.length; j ++){\n            for(let k = j + 1; k < all_pieces.length; k ++){\n                for(let l = k + 1; l < all_pieces.length; l ++){\n                    for(let m = l + 1; l < all_pieces.length; l ++){\n                        const piece_combo = [all_pieces[i], all_pieces[j], all_pieces[k], all_pieces[l], all_pieces[m]]\n                        const ids = collapsed(piece_combo, boardState, team, 5)\n                        if (ids.length + arr2[i] + arr2[j] + arr2[k] + arr2[l] + arr2[m] === \n                                         arr1[i] + arr1[j] + arr1[k] + arr1[l] + arr2[m]){\n                            remove(piece_combo, boardState, team, 5)               \n                        }\n                    }\n                }\n            }\n        }\n    }\n}\n\n\n\nexport default function fullReduction(boardState : Piece []){\n    let somethingChanged = true\n    while (somethingChanged === true){\n        first_level_collapse(boardState, TeamType.WHITE)\n        first_level_collapse(boardState, TeamType.BLACK)\n        second_level_collapse(boardState, TeamType.WHITE)\n        second_level_collapse(boardState, TeamType.BLACK)\n        third_level_collapse(boardState, TeamType.WHITE)\n        third_level_collapse(boardState, TeamType.BLACK)\n        fourth_level_collapse(boardState, TeamType.WHITE)\n        fourth_level_collapse(boardState, TeamType.BLACK)\n        fifth_level_collapse(boardState, TeamType.WHITE)\n        fifth_level_collapse(boardState, TeamType.BLACK)\n        somethingChanged = count !== 0\n        count = 0\n    }\n}"]},"metadata":{},"sourceType":"module"}