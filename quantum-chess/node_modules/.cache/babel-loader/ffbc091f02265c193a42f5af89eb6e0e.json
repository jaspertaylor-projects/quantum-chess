{"ast":null,"code":"import { PieceType, TeamType } from \"../constants\";\nconst all_pieces = [PieceType.KING, PieceType.QUEEN, PieceType.ROOK, PieceType.BISHOP, PieceType.NIGHT, PieceType.PAWN];\nlet whiteNumPiece = [1, 1, 2, 2, 2, 8];\nlet blackNumPiece = [1, 1, 2, 2, 2, 8];\nlet white_collapsed = [0, 0, 0, 0, 0, 0];\nlet taken_pieces_black = [];\nlet taken_pieces_white = [];\n\nfunction collapsed(piece, boardState, team) {\n  let ids = [];\n\n  for (let i = 0; i < boardState.length; i++) {\n    if (boardState[i].SuperPiece.subPieces.length === 1 && boardState[i].SuperPiece.subPieces[0] === piece && boardState[i].SuperPiece.team === team) {\n      ids.push(i);\n    }\n  }\n\n  return ids;\n}\n\nfunction uncollapsed(piece, boardState, team) {\n  let ids = [];\n\n  for (let i = 0; i < boardState.length; i++) {\n    if (boardState[i].SuperPiece.subPieces.length > 1 && boardState[i].SuperPiece.subPieces.includes(piece) && boardState[i].SuperPiece.team === team) {\n      ids.push(i);\n    }\n  }\n\n  return ids;\n}\n\nfunction removeOne(piece, boardState, team) {\n  for (let i = 0; i < boardState.length; i++) {\n    if (boardState[i].SuperPiece.subPieces.length > 1 && boardState[i].SuperPiece.subPieces.includes(piece) && boardState[i].SuperPiece.team === team) {\n      const id = boardState[i].SuperPiece.subPieces.indexOf(piece);\n      boardState[i].SuperPiece.subPieces.splice(id, 1);\n    }\n  }\n}\n\nfunction removeAll(piece, boardState, team) {\n  for (let i = 0; i < boardState.length; i++) {\n    if (boardState[i].SuperPiece.subPieces.length > 1 && boardState[i].SuperPiece.subPieces.includes(piece) && boardState[i].SuperPiece.team === team) {\n      const id = boardState[i].SuperPiece.subPieces.indexOf(piece);\n      boardState[i].SuperPiece.subPieces.splice(0, id);\n      boardState[i].SuperPiece.subPieces = [boardState[i].SuperPiece.subPieces[0]];\n    }\n  }\n}\n\nfunction collapseOne(boardState, team) {\n  if (team === TeamType.WHITE) {\n    for (let i = 0; i < all_pieces.length; i++) {\n      const ids = collapsed(all_pieces[i], boardState, team);\n\n      if (ids.length >= whiteNumPiece[i]) {\n        removeOne(all_pieces[i], boardState, team);\n      }\n    }\n  } else {\n    for (let i = 0; i < all_pieces.length; i++) {\n      const ids = collapsed(all_pieces[i], boardState, team);\n\n      if (ids.length >= blackNumPiece[i]) {\n        removeOne(all_pieces[i], boardState, team);\n      }\n    }\n  }\n}\n\nfunction collapseAll(boardState, team) {\n  if (team === TeamType.WHITE) {\n    for (let i = 0; i < all_pieces.length; i++) {\n      const ids = uncollapsed(all_pieces[i], boardState, team);\n      const ids2 = collapsed(all_pieces[i], boardState, team);\n\n      if (ids.length + ids2.length <= whiteNumPiece[i]) {\n        removeAll(all_pieces[i], boardState, team);\n      }\n    }\n  } else {\n    for (let i = 0; i < all_pieces.length; i++) {\n      const ids = uncollapsed(all_pieces[i], boardState, team);\n      const ids2 = collapsed(all_pieces[i], boardState, team);\n\n      if (ids.length + ids2.length <= blackNumPiece[i]) {\n        removeAll(all_pieces[i], boardState, team);\n      }\n    }\n  }\n}\n\nexport default function fullReduction(boardState) {\n  collapseOne(boardState, TeamType.WHITE);\n  collapseOne(boardState, TeamType.BLACK);\n  collapseAll(boardState, TeamType.WHITE);\n  collapseAll(boardState, TeamType.BLACK);\n}","map":{"version":3,"sources":["/home/jaybird/Coding Projects/QuantumChess/quantum-chess/src/Referee/stateReducer.ts"],"names":["PieceType","TeamType","all_pieces","KING","QUEEN","ROOK","BISHOP","NIGHT","PAWN","whiteNumPiece","blackNumPiece","white_collapsed","taken_pieces_black","taken_pieces_white","collapsed","piece","boardState","team","ids","i","length","SuperPiece","subPieces","push","uncollapsed","includes","removeOne","id","indexOf","splice","removeAll","collapseOne","WHITE","collapseAll","ids2","fullReduction","BLACK"],"mappings":"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","sourcesContent":["import { Piece, PieceType, TeamType } from \"../constants\";\n\n\nconst all_pieces = [PieceType.KING, PieceType.QUEEN, PieceType.ROOK, PieceType.BISHOP, PieceType.NIGHT, PieceType.PAWN]\n\n\nlet whiteNumPiece : number [] = [1, 1, 2, 2, 2, 8]\nlet blackNumPiece : number [] = [1, 1, 2, 2, 2, 8]\nlet white_collapsed : number [] = [0, 0, 0, 0, 0, 0]\nlet taken_pieces_black : PieceType [] = []\nlet taken_pieces_white : PieceType [] = []\n\n\n\n\nfunction collapsed(piece : PieceType, boardState : Piece [], team : TeamType) : number [] {\n    let ids : number [] = []\n    for(let i = 0; i < boardState.length; i ++){\n        if (boardState[i].SuperPiece.subPieces.length === 1 && \n            boardState[i].SuperPiece.subPieces[0] === piece &&\n            boardState[i].SuperPiece.team === team){\n            ids.push(i)\n        }\n    }\n    return ids\n}\n\nfunction uncollapsed(piece : PieceType, boardState : Piece [], team : TeamType) : number [] {\n    let ids : number [] = []\n    for(let i = 0; i < boardState.length; i ++){\n        if (boardState[i].SuperPiece.subPieces.length > 1 && \n            boardState[i].SuperPiece.subPieces.includes(piece) &&\n            boardState[i].SuperPiece.team === team){\n            ids.push(i)\n        }\n    }\n    return ids\n}\n\nfunction removeOne(piece : PieceType, boardState : Piece [], team : TeamType){\n    for(let i = 0; i < boardState.length; i ++){\n        if (boardState[i].SuperPiece.subPieces.length > 1 && \n            boardState[i].SuperPiece.subPieces.includes(piece) && \n            boardState[i].SuperPiece.team === team){\n            const id = boardState[i].SuperPiece.subPieces.indexOf(piece)\n            boardState[i].SuperPiece.subPieces.splice(id, 1)\n        }\n    }\n}\n\nfunction removeAll(piece : PieceType, boardState : Piece [], team : TeamType){\n    for(let i = 0; i < boardState.length; i ++){\n        if (boardState[i].SuperPiece.subPieces.length > 1 && \n            boardState[i].SuperPiece.subPieces.includes(piece) && \n            boardState[i].SuperPiece.team === team){\n            const id = boardState[i].SuperPiece.subPieces.indexOf(piece)\n            boardState[i].SuperPiece.subPieces.splice(0, id)\n            boardState[i].SuperPiece.subPieces = [boardState[i].SuperPiece.subPieces[0]]\n        }\n    }\n}\n\nfunction collapseOne(boardState : Piece [], team : TeamType){\n    if (team === TeamType.WHITE){\n        for (let i =  0; i < all_pieces.length; i++){\n            const ids = collapsed(all_pieces[i], boardState, team)\n            if (ids.length >= whiteNumPiece[i]){\n                removeOne(all_pieces[i], boardState, team)\n            }\n        }\n    }\n    else {\n        for (let i =  0; i < all_pieces.length; i++){\n            const ids = collapsed(all_pieces[i], boardState, team)\n            if (ids.length >= blackNumPiece[i]){\n                removeOne(all_pieces[i], boardState, team)\n            }\n        }\n    }\n\n}\n\nfunction collapseAll(boardState : Piece [], team : TeamType){\n    if (team === TeamType.WHITE){\n        for (let i =  0; i < all_pieces.length; i++){\n            const ids = uncollapsed(all_pieces[i], boardState, team)\n            const ids2 = collapsed(all_pieces[i], boardState, team)\n            if (ids.length + ids2.length <= whiteNumPiece[i]){\n                removeAll(all_pieces[i], boardState, team)\n            }\n        }\n    }\n    else {\n        for (let i =  0; i < all_pieces.length; i++){\n            const ids = uncollapsed(all_pieces[i], boardState, team)\n            const ids2 = collapsed(all_pieces[i], boardState, team)\n            if (ids.length + ids2.length <= blackNumPiece[i]){\n                removeAll(all_pieces[i], boardState, team)\n            }\n        }\n    }\n\n}\n\n\nexport default function fullReduction(boardState : Piece []){\n    collapseOne(boardState, TeamType.WHITE)\n    collapseOne(boardState, TeamType.BLACK)\n    collapseAll(boardState, TeamType.WHITE)\n    collapseAll(boardState, TeamType.BLACK)\n}"]},"metadata":{},"sourceType":"module"}